{% extends "base.html" %}

{% block content %}
<!-- Hero Section -->
<section class="hero-section">
    <div class="container text-center">
        <h1 class="fade-in">An치lisis de Correspondencia Multivariado</h1>
        <p class="lead fade-in">Descubre patrones ocultos en tus datos categ칩ricos con ACM</p>
        <a href="#que-es-acm" class="btn btn-light btn-lg me-3">
            <i class="fas fa-play me-2"></i>Empezar a Aprender
        </a>
        <a href="{{ url_for('acm_tool') }}" class="btn btn-outline-light btn-lg">
            <i class="fas fa-tools me-2"></i>Iniciar Prueba ACM
        </a>
    </div>
</section>

<!-- 쯈u칠 es el ACM? -->
<div class="container">
    <div class="info-card slide-up" id="que-es-acm">
        <h2>
            <i class="fas fa-question-circle card-icon"></i>
            쯈u칠 es el An치lisis de Correspondencia M칰ltiple?
        </h2>
        <p>
            El <strong>An치lisis de Correspondencia M칰ltiple (ACM)</strong> es una t칠cnica estad칤stica multivariada 
            que permite explorar las relaciones entre m칰ltiples variables categ칩ricas. Es una extensi칩n del an치lisis 
            de correspondencia simple que trabaja con m치s de dos variables.
        </p>
        <p>
            Esta t칠cnica es especialmente 칰til para:
        </p>
        <ul class="list-unstyled">
            <li><i class="fas fa-check text-success me-2"></i>Identificar patrones en encuestas y cuestionarios</li>
            <li><i class="fas fa-check text-success me-2"></i>Analizar perfiles de consumidores</li>
            <li><i class="fas fa-check text-success me-2"></i>Estudiar comportamientos sociales</li>
            <li><i class="fas fa-check text-success me-2"></i>Reducir la dimensionalidad de datos categ칩ricos</li>
        </ul>
        <div class="alert alert-info mt-3">
            <i class="fas fa-lightbulb me-2"></i>
            <strong>Ejemplo pr치ctico:</strong> Imagina que tienes datos sobre preferencias de comida, edad y ciudad de residencia. 
            El ACM te ayudar칤a a descubrir que las personas j칩venes de cierta ciudad prefieren comida r치pida.
        </div>
    </div>

    <!-- Fundamentos Matem치ticos -->
    <div class="info-card slide-up">
        <h2>
            <i class="fas fa-calculator card-icon"></i>
            Fundamentos Matem치ticos y Conceptuales
        </h2>
        <p>
            El ACM se basa en la <strong>descomposici칩n en valores singulares</strong> de una matriz de indicadores. 
            Matem치ticamente, transforma variables categ칩ricas en un espacio continuo de menor dimensi칩n.
        </p>
        
        <div class="row mt-4">
            <div class="col-md-6">
                <h4 class="text-success"><i class="fas fa-cogs me-2"></i>Proceso Principal</h4>
                <ol>
                    <li><strong>Codificaci칩n:</strong> Las variables categ칩ricas se convierten en variables dummy (0 y 1)</li>
                    <li><strong>Matriz de correspondencia:</strong> Se calcula la matriz de frecuencias relativas</li>
                    <li><strong>Descomposici칩n:</strong> Se aplica la descomposici칩n en valores singulares</li>
                    <li><strong>Proyecci칩n:</strong> Los datos se proyectan en un espacio de menor dimensi칩n</li>
                </ol>
            </div>
            <div class="col-md-6">
                <h4 class="text-success"><i class="fas fa-chart-line me-2"></i>Conceptos Clave</h4>
                <ul>
                    <li><strong>Inercia:</strong> Medida de la variabilidad total en los datos</li>
                    <li><strong>Componentes:</strong> Ejes que explican la mayor varianza</li>
                    <li><strong>Contribuciones:</strong> Peso de cada variable en cada componente</li>
                    <li><strong>Coordenadas:</strong> Posici칩n de cada observaci칩n en el nuevo espacio</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Subtemas -->
    <div class="row">
        <div class="col-md-4">
            <div class="info-card slide-up">
                <h3>
                    <i class="fas fa-search text-success me-2"></i>
                    Interpretaci칩n de Resultados
                </h3>
                <p>Los resultados del ACM se interpretan principalmente a trav칠s de:</p>
                <ul>
                    <li><strong>Gr치ficos de correspondencia:</strong> Visualizaci칩n de las relaciones entre categor칤as</li>
                    <li><strong>Contribuciones relativas:</strong> Importancia de cada variable en cada dimensi칩n</li>
                    <li><strong>Proximidad:</strong> Categor칤as cercanas indican asociaci칩n</li>
                    <li><strong>Ejes principales:</strong> Direcciones de m치xima variabilidad</li>
                </ul>
            </div>
        </div>

        <div class="col-md-4">
            <div class="info-card slide-up">
                <h3>
                    <i class="fas fa-chart-bar text-success me-2"></i>
                    M칠tricas de Evaluaci칩n
                </h3>
                <p>Para evaluar la calidad del an치lisis utilizamos:</p>
                <ul>
                    <li><strong>Varianza explicada:</strong> Porcentaje de informaci칩n conservada</li>
                    <li><strong>Inercia total:</strong> Variabilidad total en los datos</li>
                    <li><strong>Calidad de representaci칩n:</strong> Qu칠 tan bien se representa cada punto</li>
                    <li><strong>Eigenvalues:</strong> Importancia de cada componente</li>
                </ul>
            </div>
        </div>

        <div class="col-md-4">
            <div class="info-card slide-up">
                <h3>
                    <i class="fas fa-balance-scale text-success me-2"></i>
                    Ventajas y Consideraciones
                </h3>
                <p><strong>Ventajas:</strong></p>
                <ul>
                    <li>Maneja m칰ltiples variables categ칩ricas</li>
                    <li>Reduce dimensionalidad</li>
                    <li>Visualizaci칩n intuitiva</li>
                    <li>No requiere distribuci칩n normal</li>
                </ul>
                <p><strong>Consideraciones:</strong></p>
                <ul>
                    <li>Sensible a categor칤as raras</li>
                    <li>Interpretaci칩n puede ser compleja</li>
                    <li>Requiere muestra suficiente</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Minijuego -->
    <div class="game-container slide-up">
        <h2 class="text-center mb-4">
            <i class="fas fa-gamepad me-3"></i>
            Simulador Interactivo de ACM
        </h2>
        <p class="text-center lead">Aprende c칩mo el ACM encuentra patrones autom치ticamente en datos categ칩ricos</p>
        
        <!-- Tutorial paso a paso -->
        <div class="row mb-4">
            <div class="col-md-3">
                <div class="tutorial-step">
                    <div class="step-number">1</div>
                    <h5>Observa</h5>
                    <p>Cada persona tiene 3 caracter칤sticas: edad, ciudad y hobby</p>
                </div>
            </div>
            <div class="col-md-3">
                <div class="tutorial-step">
                    <div class="step-number">2</div>
                    <h5>Identifica</h5>
                    <p>Busca personas que compartan 2 o m치s caracter칤sticas</p>
                </div>
            </div>
            <div class="col-md-3">
                <div class="tutorial-step">
                    <div class="step-number">3</div>
                    <h5>Agrupa</h5>
                    <p>Selecciona personas similares haciendo clic en ellas</p>
                </div>
            </div>
            <div class="col-md-3">
                <div class="tutorial-step">
                    <div class="step-number">4</div>
                    <h5>Verifica</h5>
                    <p>El ACM har칤a esto autom치ticamente con miles de datos</p>
                </div>
            </div>
        </div>

        <!-- Leyenda de caracter칤sticas -->
        <div class="characteristics-legend mb-4">
            <h5 class="text-center mb-3">
                <i class="fas fa-key me-2"></i>
                Leyenda de Caracter칤sticas
            </h5>
            <div class="row">
                <div class="col-md-4">
                    <div class="legend-item">
                        <i class="fas fa-birthday-cake text-primary"></i>
                        <strong>Edad:</strong>
                        <span class="badge bg-primary ms-2">Joven (20-30)</span>
                        <span class="badge bg-warning ms-1">Adulto (40-50)</span>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="legend-item">
                        <i class="fas fa-map-marker-alt text-success"></i>
                        <strong>Ciudad:</strong>
                        <span class="badge bg-success ms-2">Madrid</span>
                        <span class="badge bg-info ms-1">Barcelona</span>
                        <span class="badge bg-secondary ms-1">Valencia</span>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="legend-item">
                        <i class="fas fa-heart text-danger"></i>
                        <strong>Hobby:</strong>
                        <span class="badge bg-danger ms-2">Tecnolog칤a</span>
                        <span class="badge bg-dark ms-1">Cultura</span>
                        <span class="badge bg-warning ms-1">Deporte</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ejemplo visual de grupos objetivo -->
        <div class="target-groups mb-4">
            <h5 class="text-center mb-3">
                <i class="fas fa-bullseye me-2"></i>
                Grupos Objetivo a Encontrar
            </h5>
            <div class="row">
                <div class="col-md-4">
                    <div class="target-group group-a">
                        <div class="group-header">
                            <i class="fas fa-users"></i>
                            <strong>Grupo A</strong>
                        </div>
                        <div class="group-characteristics">
                            <span class="char-badge age-young">J칩venes</span>
                            <span class="char-badge city-madrid">Madrid</span>
                            <span class="char-badge hobby-tech">Tecnolog칤a</span>
                        </div>
                        <div class="group-members">Juan + Ana</div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="target-group group-b">
                        <div class="group-header">
                            <i class="fas fa-users"></i>
                            <strong>Grupo B</strong>
                        </div>
                        <div class="group-characteristics">
                            <span class="char-badge age-adult">Adultos</span>
                            <span class="char-badge city-barcelona">Barcelona</span>
                            <span class="char-badge hobby-culture">Cultura</span>
                        </div>
                        <div class="group-members">Carlos + Mar칤a</div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="target-group group-c">
                        <div class="group-header">
                            <i class="fas fa-users"></i>
                            <strong>Grupo C</strong>
                        </div>
                        <div class="group-characteristics">
                            <span class="char-badge age-young">J칩venes</span>
                            <span class="char-badge city-valencia">Valencia</span>
                            <span class="char-badge hobby-sport">Deporte</span>
                        </div>
                        <div class="group-members">Luis + Sara</div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="game-board">
            <h4 class="text-center mb-3">
                <i class="fas fa-mouse-pointer me-2"></i>
                Selecciona personas del mismo grupo
            </h4>
            <p class="text-center text-muted mb-4">Haz clic en las personas que crees que tienen caracter칤sticas similares</p>
            
            <div id="game-data" class="people-grid">
                <div class="person-card" data-group="jovenes-madrid-tech" data-tooltip="Grupo A: J칩venes de Madrid con intereses tecnol칩gicos">
                    <div class="person-avatar">
                        <i class="fas fa-user-circle"></i>
                    </div>
                    <div class="person-name">Juan</div>
                    <div class="person-characteristics">
                        <span class="char-tag age-young">25 a침os</span>
                        <span class="char-tag city-madrid">Madrid</span>
                        <span class="char-tag hobby-tech">Programaci칩n</span>
                    </div>
                </div>
                
                <div class="person-card" data-group="jovenes-madrid-tech" data-tooltip="Grupo A: J칩venes de Madrid con intereses tecnol칩gicos">
                    <div class="person-avatar">
                        <i class="fas fa-user-circle"></i>
                    </div>
                    <div class="person-name">Ana</div>
                    <div class="person-characteristics">
                        <span class="char-tag age-young">22 a침os</span>
                        <span class="char-tag city-madrid">Madrid</span>
                        <span class="char-tag hobby-tech">Videojuegos</span>
                    </div>
                </div>
                
                <div class="person-card" data-group="adultos-barcelona-cultura" data-tooltip="Grupo B: Adultos de Barcelona con intereses culturales">
                    <div class="person-avatar">
                        <i class="fas fa-user-circle"></i>
                    </div>
                    <div class="person-name">Carlos</div>
                    <div class="person-characteristics">
                        <span class="char-tag age-adult">45 a침os</span>
                        <span class="char-tag city-barcelona">Barcelona</span>
                        <span class="char-tag hobby-culture">Lectura</span>
                    </div>
                </div>
                
                <div class="person-card" data-group="adultos-barcelona-cultura" data-tooltip="Grupo B: Adultos de Barcelona con intereses culturales">
                    <div class="person-avatar">
                        <i class="fas fa-user-circle"></i>
                    </div>
                    <div class="person-name">Mar칤a</div>
                    <div class="person-characteristics">
                        <span class="char-tag age-adult">40 a침os</span>
                        <span class="char-tag city-barcelona">Barcelona</span>
                        <span class="char-tag hobby-culture">Teatro</span>
                    </div>
                </div>
                
                <div class="person-card" data-group="jovenes-valencia-deporte" data-tooltip="Grupo C: J칩venes de Valencia con intereses deportivos">
                    <div class="person-avatar">
                        <i class="fas fa-user-circle"></i>
                    </div>
                    <div class="person-name">Luis</div>
                    <div class="person-characteristics">
                        <span class="char-tag age-young">28 a침os</span>
                        <span class="char-tag city-valencia">Valencia</span>
                        <span class="char-tag hobby-sport">F칰tbol</span>
                    </div>
                </div>
                
                <div class="person-card" data-group="jovenes-valencia-deporte" data-tooltip="Grupo C: J칩venes de Valencia con intereses deportivos">
                    <div class="person-avatar">
                        <i class="fas fa-user-circle"></i>
                    </div>
                    <div class="person-name">Sara</div>
                    <div class="person-characteristics">
                        <span class="char-tag age-young">26 a침os</span>
                        <span class="char-tag city-valencia">Valencia</span>
                        <span class="char-tag hobby-sport">Tenis</span>
                    </div>
                </div>
                
                <div class="person-card" data-group="adultos-madrid-cultura" data-tooltip="Grupo D: Adultos de Madrid con intereses culturales">
                    <div class="person-avatar">
                        <i class="fas fa-user-circle"></i>
                    </div>
                    <div class="person-name">Pedro</div>
                    <div class="person-characteristics">
                        <span class="char-tag age-adult">50 a침os</span>
                        <span class="char-tag city-madrid">Madrid</span>
                        <span class="char-tag hobby-culture">M칰sica</span>
                    </div>
                </div>
                
                <div class="person-card" data-group="jovenes-barcelona-tech" data-tooltip="Grupo E: J칩venes de Barcelona con intereses tecnol칩gicos">
                    <div class="person-avatar">
                        <i class="fas fa-user-circle"></i>
                    </div>
                    <div class="person-name">Elena</div>
                    <div class="person-characteristics">
                        <span class="char-tag age-young">24 a침os</span>
                        <span class="char-tag city-barcelona">Barcelona</span>
                        <span class="char-tag hobby-tech">Programaci칩n</span>
                    </div>
                </div>
            </div>
            
            <!-- Indicadores de progreso -->
            <div class="mt-3 text-center">
                <div class="badge bg-secondary me-2">
                    <i class="fas fa-users me-1"></i>
                    Seleccionados: <span id="selected-count">0</span>
                </div>
                <div class="badge bg-info">
                    <i class="fas fa-bullseye me-1"></i>
                    Grupos encontrados: <span id="groups-found">0</span>
                </div>
            </div>
            
            <div class="text-center mt-4">
                <button id="check-game" class="btn btn-success btn-lg">
                    <i class="fas fa-check me-2"></i>Verificar Agrupaci칩n
                </button>
                <button id="reset-game" class="btn btn-outline-secondary btn-lg ms-2">
                    <i class="fas fa-refresh me-2"></i>Reiniciar
                </button>
                <button id="hint-game" class="btn btn-outline-info btn-lg ms-2">
                    <i class="fas fa-lightbulb me-2"></i>Pista
                </button>
            </div>
            
            <div id="game-result" class="mt-3" style="display: none;"></div>
        </div>
        
        <div class="alert alert-success mt-4">
            <h5><i class="fas fa-brain me-2"></i>쯈u칠 aprender치s?</h5>
            <div class="row">
                <div class="col-md-6">
                    <ul class="mb-0">
                        <li><strong>Patrones:</strong> C칩mo identificar similitudes en datos categ칩ricos</li>
                        <li><strong>Agrupaci칩n:</strong> Elementos similares tienden a estar juntos</li>
                    </ul>
                </div>
                <div class="col-md-6">
                    <ul class="mb-0">
                        <li><strong>ACM real:</strong> Hace esto autom치ticamente con miles de variables</li>
                        <li><strong>Visualizaci칩n:</strong> Representa grupos en gr치ficos 2D</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Bot칩n principal -->
    <div class="text-center my-5">
        <a href="{{ url_for('acm_tool') }}" class="btn btn-primary btn-lg">
            <i class="fas fa-rocket me-3"></i>
            Iniciar Prueba ACM
        </a>
        <p class="mt-3 text-muted">춰Comienza a analizar tus propios datos ahora!</p>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const dataPoints = document.querySelectorAll('.person-card');
    const checkButton = document.getElementById('check-game');
    const resetButton = document.getElementById('reset-game');
    const hintButton = document.getElementById('hint-game');
    const resultDiv = document.getElementById('game-result');
    const selectedCount = document.getElementById('selected-count');
    const groupsFound = document.getElementById('groups-found');
    
    let selectedGroups = {};
    let hintsUsed = 0;
    
    // Grupos correctos para el tutorial
    const correctGroups = {
        'jovenes-madrid-tech': ['Juan (25, Madrid, Programaci칩n)', 'Ana (22, Madrid, Videojuegos)'],
        'adultos-barcelona-cultura': ['Carlos (45, Barcelona, Lectura)', 'Mar칤a (40, Barcelona, Teatro)'],
        'jovenes-valencia-deporte': ['Luis (28, Valencia, F칰tbol)', 'Sara (26, Valencia, Tenis)'],
        'adultos-madrid-cultura': ['Pedro (50, Madrid, M칰sica)'],
        'jovenes-barcelona-tech': ['Elena (24, Barcelona, Programaci칩n)']
    };
    
    // Agregar funcionalidad de clic para las tarjetas de personas
    dataPoints.forEach(point => {
        point.addEventListener('click', function() {
            this.classList.toggle('selected');
            updateCounters();
            
            // Efecto de pulso al seleccionar
            if (this.classList.contains('selected')) {
                this.style.animation = 'pulse 0.3s ease-in-out';
            } else {
                this.style.animation = '';
            }
        });
    });
    
    function updateCounters() {
        const selected = document.querySelectorAll('.person-card.selected');
        selectedCount.textContent = selected.length;
        
        // Contar grupos 칰nicos seleccionados
        const uniqueGroups = new Set();
        selected.forEach(point => {
            uniqueGroups.add(point.dataset.group);
        });
        groupsFound.textContent = uniqueGroups.size;
    }
    
    checkButton.addEventListener('click', function() {
        const selected = document.querySelectorAll('.person-card.selected');
        
        if (selected.length < 2) {
            showResult('춰Selecciona al menos 2 personas para formar un grupo!', 'warning');
            return;
        }
        
        // Verificar agrupaciones
        const groups = {};
        selected.forEach(point => {
            const group = point.dataset.group;
            const name = point.querySelector('.person-name').textContent.trim();
            if (!groups[group]) groups[group] = [];
            groups[group].push(name);
        });
        
        // An치lisis detallado de los grupos
        let perfectGroups = 0;
        let partialGroups = 0;
        let mixedGroups = 0;
        let totalPairs = 0;
        
        for (let group in groups) {
            const groupSize = groups[group].length;
            if (groupSize >= 2) {
                totalPairs += groupSize;
                
                // Verificar si es un grupo perfecto
                if (group === 'jovenes-madrid-tech' && groupSize === 2) {
                    perfectGroups++;
                } else if (group === 'adultos-barcelona-cultura' && groupSize === 2) {
                    perfectGroups++;
                } else if (group === 'jovenes-valencia-deporte' && groupSize === 2) {
                    perfectGroups++;
                } else if (groupSize > 1) {
                    partialGroups++;
                } else {
                    mixedGroups++;
                }
            }
        }
        
        // Mostrar resultados detallados
        if (perfectGroups > 0 && mixedGroups === 0) {
            showResult(`
                <h5>춰Excelente trabajo!</h5>
                <p>Has identificado <strong>${perfectGroups}</strong> grupo(s) correctamente.</p>
                <p><strong>쯈u칠 significa esto?</strong></p>
                <ul>
                    <li>Has encontrado personas con caracter칤sticas similares</li>
                    <li>En el ACM real, estos grupos aparecer칤an cerca en el gr치fico</li>
                    <li>Cada grupo comparte 2-3 caracter칤sticas importantes</li>
                </ul>
                <p class="text-success"><strong>춰Entiendes c칩mo funciona el ACM!</strong></p>
            `, 'success');
        } else if (perfectGroups > 0 || partialGroups > 0) {
            showResult(`
                <h5>춰Buen intento!</h5>
                <p>Has encontrado algunos patrones correctos:</p>
                <ul>
                    <li>Grupos correctos: <strong>${perfectGroups}</strong></li>
                    <li>Grupos parciales: <strong>${partialGroups}</strong></li>
                </ul>
                <p><strong>Consejo:</strong> F칤jate en las caracter칤sticas que comparten: edad, ciudad y hobby.</p>
                <p>El ACM real har칤a esto autom치ticamente con miles de variables.</p>
            `, 'info');
        } else {
            showResult(`
                <h5>춰Sigue intentando!</h5>
                <p>No has encontrado grupos correctos, pero est치s aprendiendo:</p>
                <ul>
                    <li>Busca personas con <strong>edad similar</strong></li>
                    <li>Que vivan en la <strong>misma ciudad</strong></li>
                    <li>Con <strong>hobbies relacionados</strong></li>
                </ul>
                <p>Consejo: Usa el bot칩n "Pista" para ayuda.</p>
            `, 'warning');
        }
    });
    
    hintButton.addEventListener('click', function() {
        hintsUsed++;
        
        if (hintsUsed === 1) {
            showResult(`
                <h5>游눠 Pista 1: Busca por edad</h5>
                <p>Agrupa personas de edades similares:</p>
                <ul>
                    <li><strong>J칩venes:</strong> 22-28 a침os</li>
                    <li><strong>Adultos:</strong> 40-50 a침os</li>
                </ul>
                <p>춰Pero tambi칠n f칤jate en las otras caracter칤sticas!</p>
            `, 'info');
        } else if (hintsUsed === 2) {
            showResult(`
                <h5>游눠 Pista 2: A침ade ubicaci칩n</h5>
                <p>Dentro de cada grupo de edad, busca por ciudad:</p>
                <ul>
                    <li><strong>Madrid:</strong> Juan, Ana, Pedro</li>
                    <li><strong>Barcelona:</strong> Carlos, Mar칤a, Elena</li>
                    <li><strong>Valencia:</strong> Luis, Sara</li>
                </ul>
                <p>춰Ya casi lo tienes!</p>
            `, 'info');
        } else {
            showResult(`
                <h5>游눠 Pista 3: Grupos completos</h5>
                <p>Los grupos ideales son:</p>
                <ul>
                    <li><strong>Grupo A:</strong> Juan + Ana (j칩venes Madrid + tecnolog칤a)</li>
                    <li><strong>Grupo B:</strong> Carlos + Mar칤a (adultos Barcelona + cultura)</li>
                    <li><strong>Grupo C:</strong> Luis + Sara (j칩venes Valencia + deporte)</li>
                </ul>
                <p>Pedro y Elena son casos 칰nicos en sus combinaciones.</p>
            `, 'success');
        }
    });
    
    resetButton.addEventListener('click', function() {
        dataPoints.forEach(point => {
            point.classList.remove('selected');
            point.style.animation = '';
        });
        resultDiv.style.display = 'none';
        hintsUsed = 0;
        updateCounters();
    });
    
    function showResult(message, type) {
        resultDiv.innerHTML = `
            <div class="alert alert-${type === 'success' ? 'success' : type === 'warning' ? 'warning' : 'info'}">
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'warning' ? 'exclamation-triangle' : 'info-circle'} me-2"></i>
                ${message}
            </div>
        `;
        resultDiv.style.display = 'block';
        
        // Scroll to result
        resultDiv.scrollIntoView({ behavior: 'smooth' });
    }
    
    // Inicializar contadores
    updateCounters();
});
</script>
{% endblock %}